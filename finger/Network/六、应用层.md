1.网络应用体系结构
> 1）C/S结构
>>服务器(Server)
>> > $7*24$小时提供服务
>> >永久性可访问地址/域名
>>>利用大量服务器实现可扩展性
>>>运行专门提供某种服务的程序

>>客户机(Client)
>>>与服务器通信，使用服务器提供的服务
>>>间歇性接入网络
>>>可能使用动态IP地址
>>>不会与其他客户机直接通信

>>特点：
>>>客户机是服务的请求方，服务器是服务的提供方
>>>网络中各计算机的地位不平等，服务器可以通过对用户权限的限制来达到管理客户机的目的
>>>客户机之间不直接通信
>>>可扩展性不佳

>2）P2P结构(Peer to peer)
>>任意一对计算机可以直接互相通信
>>优点：高度可伸缩
>> 缺点：难以管理

>3）混合结构：
>>文件传输使用P2P结构
>>文件的搜索使用C/S结构
>>每个结点向中央服务器登机自己的内容
>>每个结点向中央服务器提交查询请求，查找感兴趣的内容

 2.网络应用通信原理
>网络应用基础：进程间通信
>>同一主机
>>>进程间通信机制，由OS提供

>>不同进程：
>>>消息交换
>>>进程间通信利用socket发送/接收消息
>>>如何寻址进程：<IP地址，端口号>
	 
>应用层协议：
>>公开协议：FTP、SMTP...
>>私有协议：多数P2P文件共享 应用
>>应用层协议内容:
>>>消息类型：
>>>>a）请求
>>>>b）响应

>>>消息语法格式：
>>>>有哪些字段，字段如何描述

>>>字段的语义：
>>>>字段信息的含义

>>>规则：
>>>>进程何时发送/响应消息
>>>>进程如何发送/响应消息

>>网络应用对传输服务的需求：
		 a）数据丢失/可靠性
		 b）时间/延迟
		 c）带宽
 3.DNS(Domain Name System)
>将主机名转换为IP地址，采用C/S结构，协议运行在UDP之上，使用53端口
>概念上DNS由三个部分组成:
>>1）层次命名空间:
>>>三级域名.二级域名.顶级域名
>>>> a）标号中的英文不区分大小写
>>>> b）标号中除了连字符'-'外不能使用其他的标点符号
>>>> c）每个标号不超过64个字符，完整域名最长不超过255个字符
>>>> d）级别最低的在最左边，级别最高的在最右边

>>>顶级域名包括：
>>>>a）国家地区顶级域名
>>>>b）通用顶级域名(.com),(.org)
>>>>c）基础结构域名

>>2）域名服务器
>>>多层命名服务器构成的分布式数据库
>>>a）根域名服务器
>>>> 最高层次，知道所有顶级域名服务器的地址.
>>>>通常不把待查询的域名直接转换成IP地址，而是告诉本地域名服务器下一步应该找哪个顶级域名服务器.
>>>b）顶级域名服务器
>>>>管理注册在该顶级域名服务器的所有二级域名
>>>c）授权域名服务器
>>>>每台主机都必须在授权域名服务器等级
>>>d）本地域名服务器
>>>>一台主机发出DNS查询请求时，就将查询报文发送给该主机的本地域名服务器.

>>3）解析器
>>>解析过程
>>>>![[Pasted image 20230528145008.png]]>>>> ![[Pasted image 20230528145032.png]]
			 
>>当域名服务器获得了<域名，IP>的映射，就会缓存一段时间.
>>>资源记录(RR, resource records)
>>>> RR format:(name, value, type, ttl)

>>>>Type =A 
>>>>>Name：主机域名
>>>>>Value：IP地址

>>>>Type =B:
>>>>>Name：域(edu.cn)
>>>>>Value：该域权威域名服务器的主机域名(dns.edu.cn)

>>>>Type = CNAME
>>>>>Name：某一真实域名的别名
>>>>>Value：真实域名

>>>>Type = MX
>>>>>Name：邮件服务器别名
>>>>>Value： 邮件服务器域名
>>![[Pasted image 20230528150354.png]]
 
 4.FTP协议
	 采用C/S结构，运行在端口21上
	 FTP提供以下功能：
		 1）提供不同种类主机系统之间的文件传输能力
		 2）以用户权限管理的方式提供用户对远程FTP服务器上的文件传输能力
		 3）以匿名FTP方式提供公用文件共享的能力
	 一个FTP服务器进程可同时为多个用户进程提供服务，FTP服务器进程由一个主进程(负责接收信道请求)
	 若干从进程(负责处理单个请求)
	 工作步骤如下：
		 打开熟知端口21
		 等待客户发送连接请求
		 从属进程处理客户进程请求
		 回到等待状态
	FTP在工作时使用两个并行的TCP连接，一个是TCP控制连接21，一个是数据连接20
		1）客户端通过控制连接获得身份确认
			 客户端通过控制连接发送命令浏览远程目录
		2）收到一个文件传输命令时服务器打开一个到客户端的TCP数据连接。
			服务器打开第二个TCP数据连接用来传输另一个文件
			控制连接：带外传送
			FTP服务器维护用户的状态信息：当前路径、用户账户于控制连接对应
 Email应用
	 组成
		 1）邮件客户端，也叫用户代理(user angent)
					读写Email消息
					于服务器交互，收发Email消息
		 2）邮件服务器(Mail Server)
			 邮箱：存储发给该用户的Email
			 消息队列：存储等待发送的Email
		 3）SMTP协议：
			 邮件服务器之间传递消息使用的协议 
		 4）邮件访问协议：POP
				 下载并删除模式：
					 下载邮件后就在邮箱中删除
				 下载并保持：
					 下载邮件后邮箱不会删除邮件
             POP是无状态的	 
 Web与HTTP
		 网页包含多个对象：
			 对象：HTML文件、JPEG图片、视频文件、动态脚本
		     基本HTML文件：包含对其他对象引用的连接
	     对象的寻址：
		     URL(Uniform Resource Locator):同一资源定位器
		 万维网遵循的协议：HTTP(HyperText Transfer Protocol)
			 C/S结构：
				 C：Browser：请求、接收、展示Web对象
				 S：Web Server：响应客户的请求、发送对象
			 使用TCP连接，在80端口
			 无状态：服务器不维护任何有关客户端过去所发请求的信息
	     HTTP消息：
		     1）请求消息
			     ![[Pasted image 20230531191505.png]]
			     方法类型：
				     HTTP/1.0
					     GET
					     POST(表单提交)
					     HEAD：请Server不要将所请求的对象放入响应消息中
				    HTTP/1.1
					    GET、POST、HEAD
					    PUT，将消息体中的文件上传到URL字段所指定的路径
					    DELETE
						    删除URL字段所指定的文件
			 2）响应消息：
				 ![[Pasted image 20230531191801.png]]
				 响应码：
					 200 OK
					 301 Moved Permanently
					 400 Bad request
					 404 Not Found
					 505 HTTP VERSION Not Supported	 
		HTTP/1.0的请求响应过程
			每个TCP连接传输一个对象
			非持久性连接
			例子：假定用户在浏览器中输入URL: www.someSchool.edu/someDepartment/home.index
			1a）HTTP(浏览器)客户端向地址为www.someschool.edu的服务器的HTTP服务器进程发起TCP连接请求
			1b）HTTP服务器在端口80等待,接收连接请求
			2）HTTP客户端将HTTP请求消息通过TCP连接的套接字发出，消息中所含的URL表明客户端需要的对象
			3）HTTP服务器收到请求消息，解析，产生包含所需要对象的响应消息，并通过套接字发送给客户端
			4）HTTP服务器关闭连接
			5）HTTP客户端收到响应消息，解析html文件发现有10个指向jpeg对象的超链接
			6）为每个jpeg对象重复1-5   
			响应时间分析：
				发起、建立TCP连接：1个RTT
				发送HTTP请求消息到HTTP响应消息的前几个字节达到：1个RTT
				总的响应时间=2RTT+响应消息发送时间(服务器将文件发送出来的时间)
			 如何改进：
				 打开多个并行的TCP连接
				 还可以使用持久连接：
					 发送响应后，服务器保持TCP连接打开
					 后续的HTTP消息也可以通过这个连接发送
					 每个TCP连接可以发送多个HTTP对象
					 非流水持久连接：
						 客户端收到前一个响应后才发送信道请求，每个被引用的对象耗时一个RTT
					 流水的持久连接：HTTP/1.1默认使用
						 客户端只要遇到一个引用对象就尽快发出请求
						 理想情况下，收到所有的引用对象只需要耗时1个RTT
					![[Pasted image 20230531203708.png]]
				 HTTP/1.1有什么不足：
					 考虑以下情况：
						 HTTP连续请求1个大对象和3个小对象，那么这3个小对象要等到大对象传输完后才能传输：
					 如何继续优化：
				 HTTP/2：减少多对象请求的时延
					 将对象分割为系列”帧“，不同对象的帧交替传输，对象传输顺序基于客户定义的对象优先级
				 HTTP/3
					 在UDP上实现应用，将传输层功能移到应用层
					 QUIC(Quick UDP Internet Connections)
						 应用层实现连接建立、错误控制、拥塞控制等功能
							 差错控制和拥塞控制：采用类似于TCP的丢失检测和拥塞控制的算法
							 连接建立：可靠性、拥塞控制、身份验证、加密、在1个RTT建立状态
					 TCP+TLS需要2轮握手
					 QUIC需要1轮握手
	 Web缓存/代理
		 在不访问源服务器的前提下满足客户端的HTTP请求
			 缩短客户请求的响应时间
			 减少机构/组织的流量
			 在大范围内实现有效的内容分发
			 Web缓存/代理服务器
				 用户设定浏览器通过缓存进行Web访问
				 浏览器向缓存/代理服务器发送所有的HTTP请求
					 如果所请求对象在缓存中，缓存返回对象
					 否则缓存服务器向原始服务器发送HTTP请求，获取对象然后返回给客户端并保存该对象
					 缓存既充当客户端也充当服务端
				 条件性GET方法：
					 目标：如果缓存有最新的版本，则不需要发送请求对象
					 缓存：在HTTP请求消息中声明所持有的版本的日期 if-modified-since:data
					 服务器：
						 如果缓存的版本是最新的则响应消息中不包含对象
	 Cookies 技术
		 某些网站为了辨别用户身份、进行session跟踪而储存在本地终端上的数据
		 能够用于：
			 身份认证
			 购物车
			 推荐 
 P2P应用：
	从一个服务器向N个节点分发一个文件需要多少时间
	     C/S:
	         服务器串行的发送N个副本:$NF/u_{s}$
		     每个客户机必须下载1个文件副本
			     客户i下载1个文件副本时间：$F/d_{i}$
			     下行带宽最小的客户下载1个副本时间:$F/d_{min}$
			     $D_{c-s}\geq\{NF/u_{s},F/d_{min}\}$
		 P2P:
			 服务器必须至少上传1个副本：$F/u_{s}$
			 每个客户机必须下载1个文件副本:
				 客户i下载1个文件副本时间：$F/d_{i}$
			     下行带宽最小的客户下载1个副本时间:$F/d_{min}$
			 服务器与客户共同上传NF比特数据时间：$NF/(u_{s}+Σu_{i})$
			 $D_{P2P}\geq\{NF/u_{s},F/d_{min},NF/(u_{s}+Σu_{i})\}$
			 
				 

		   